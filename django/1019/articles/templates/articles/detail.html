{% extends 'base.html' %}
{% load django_bootstrap5 %}
{% block title %}상세보기{% endblock title %}

{% block content %}
  <div class="m-3">
    <h1>{{ articles.title }}</h1>
    <hr>
    <p>작성자 : {{ articles.user }}
    <p>{{ articles.content }}</p>
    
    {% if articles.image %}
    <img src="{{ articles.image.url }}" alt="{{ articles.image }}"><br>
    
    {% endif %}
    {% if request.user.is_authenticated %}
    <a class="btn btn-dark py-sm-1 my-3" href="" role="button">수정하기</a>
    {% endif %}
    {% comment %} <a class="btn btn-danger py-sm-1" href="{% url 'articles:delete' articles.pk %}" role="button">삭제</a> {% endcomment %}
  </div>
  <hr>
  {% if request.user.is_authenticated %}
  <div>
    <form action="{% url 'articles:comment_create' articles.pk %}" method="POST">
        {% csrf_token %}
        {% bootstrap_form comment_form layout='inline'%}
        <input type="submit" class='btn btn-dark mt-2' value='댓글달기'>
    </form>
  </div>
  {% endif %}
  <h3 class='mt-4'>댓글</h3>
  {% if comments %}
    <p><b>{{comments|length }}개의 댓글이 있습니다.</b></p>
  {% endif %}
  <hr>
  {% for comment in articles.comment_set.all %}
  <div class='d-flex justify-content-between'>
    <p class='text-start layout-inline'>{{ comment.content }}</p>
    <p class='text-end layout-inline'>{{ comment.created_at }}</p>
  </div>
  <div class='text-end'>
    <form action="{% url 'articles:comment_delete' articles.pk comment.pk %}" method="POST">
        {% csrf_token %}
        <input type="submit" class='btn btn-dark' value='삭제'>
    </form>
  </div>
  <hr>
  {% empty %}
  <p>no comment....</p>
  {% endfor %}
{% endblock content %}